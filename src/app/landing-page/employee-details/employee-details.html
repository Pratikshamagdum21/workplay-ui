<div class="employee-list-container">
    <p-toast></p-toast>
    <p-confirmDialog></p-confirmDialog>

    <!-- Page Header -->
    <div class="page-header">
        <div class="header-content">
            <div class="header-text">
                <h1>
                    <i class="pi pi-users"></i> Employee Management
                </h1>
                <p class="subtitle">Manage employee information, salary, and advances</p>
            </div>
            <div class="header-actions">
                <p-button label="Add Employee" icon="pi pi-plus" severity="success" (onClick)="openAddDialog()">
                </p-button>
            </div>
        </div>
    </div>

    <!-- Employee Table -->
    <p-card header="Employee List" styleClass="employee-table-card">
        <p-table [value]="employees" [paginator]="true" [rows]="rows" [rowsPerPageOptions]="[10, 25, 50]" [showCurrentPageReport]="true" currentPageReportTemplate="Showing {first} to {last} of {totalRecords} employees" [(first)]="first" [totalRecords]="totalRecords"
            [tableStyle]="{ 'min-width': '480px' }" styleClass="p-datatable-striped" [scrollable]="true">

            <ng-template pTemplate="header">
                <tr>
                    <th pSortableColumn="employeeName" style="width: 20%">
                        Employee Name
                        <p-sortIcon field="employeeName"></p-sortIcon>
                    </th>
                    <th pSortableColumn="fabricType" style="width: 15%">
                        Fabric Type
                        <p-sortIcon field="fabricType"></p-sortIcon>
                    </th>
                    <th pSortableColumn="bonusEligible" style="width: 15%">
                        Bonus Eligibility
                        <p-sortIcon field="bonusEligible"></p-sortIcon>
                    </th>
                    <th pSortableColumn="advanceAmount" style="width: 15%" class="text-right">
                        Advance Amount
                        <p-sortIcon field="advanceAmount"></p-sortIcon>
                    </th>
                    <th pSortableColumn="salary" style="width: 15%" class="text-right">
                        Salary
                        <p-sortIcon field="salary"></p-sortIcon>
                    </th>
                    <th style="width: 20%" class="text-center">Actions</th>
                </tr>
            </ng-template>

            <ng-template pTemplate="body" let-employee>
                <tr>
                    <td>
                        <div class="employee-name-cell">
                            <i class="pi pi-user"></i> {{ employee.name }}
                        </div>
                    </td>
                    <td>
                        <p-tag [value]="employee.fabricType" severity="info"></p-tag>
                    </td>
                    <td>
                        <p-tag [value]="employee.bonusEligible" [severity]="employee.bonusEligible === 'With Bonus' ? 'success' : 'warn'">
                        </p-tag>
                    </td>
                    <td class="text-right">
                        <span class="amount-value">{{ formatCurrency(employee.advanceAmount) }}</span>
                    </td>
                    <td class="text-right">
                        <span class="salary-value">{{ formatCurrency(employee.salary) }}</span>
                    </td>
                    <td class="text-center">
                        <div class="action-buttons">
                            <p-button icon="pi pi-eye" severity="info" [text]="true" [rounded]="true" pTooltip="View Details" tooltipPosition="top" (onClick)="openViewDialog(employee)">
                            </p-button>
                            <p-button icon="pi pi-pencil" severity="success" [text]="true" [rounded]="true" pTooltip="Edit Employee" tooltipPosition="top" (onClick)="openEditDialog(employee)">
                            </p-button>
                            <p-button icon="pi pi-trash" severity="danger" [text]="true" [rounded]="true" pTooltip="Delete Employee" tooltipPosition="top" (onClick)="confirmDelete(employee)">
                            </p-button>
                        </div>
                    </td>
                </tr>
            </ng-template>

            <ng-template pTemplate="emptymessage">
                <tr>
                    <td colspan="6" class="text-center">
                        <div class="empty-message">
                            <i class="pi pi-users"></i>
                            <p>No employees found</p>
                            <small>Click "Add Employee" to get started</small>
                        </div>
                    </td>
                </tr>
            </ng-template>
        </p-table>
    </p-card>

    <!-- Add Employee Dialog -->
    <p-dialog header="Add New Employee" [(visible)]="displayAddDialog" [modal]="true" [style]="{ width: '50vw' }" [breakpoints]="{ '960px': '75vw', '640px': '100vw', '480px': '100vw' }" [draggable]="false" [resizable]="false" styleClass="add-employee-dialog">
        <app-add-employee [isEditMode]="false" (employeeSaved)="onEmployeeAdded()" (cancelled)="closeAddDialog()">
        </app-add-employee>
    </p-dialog>

    <!-- Edit Employee Dialog -->
    <p-dialog header="Edit Employee" [(visible)]="displayEditDialog" [modal]="true" [style]="{ width: '50vw' }" [breakpoints]="{ '960px': '75vw', '640px': '100vw', '480px': '100vw' }" [draggable]="false" [resizable]="false" styleClass="edit-employee-dialog">
        <app-add-employee [isEditMode]="true" [employeeData]="selectedEmployee!" (employeeSaved)="onEmployeeUpdated()" (cancelled)="closeEditDialog()">
        </app-add-employee>
    </p-dialog>

    <!-- View Employee Dialog -->
    <p-dialog header="Employee Details" [(visible)]="displayViewDialog" [modal]="true" [style]="{ width: '50vw' }" [breakpoints]="{ '960px': '75vw', '640px': '100vw', '480px': '100vw' }" [draggable]="false" [resizable]="false" styleClass="view-employee-dialog">
        <app-view-employee-details [employee]="selectedEmployee" (closed)="closeViewDialog()">
        </app-view-employee-details>
    </p-dialog>
</div>